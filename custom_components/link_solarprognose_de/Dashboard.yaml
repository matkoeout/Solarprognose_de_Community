views:
  - title: Solarprognose
    sections:
      - icon: mdi:solar-power
        cards:
          - type: vertical-stack
            cards:
              - type: grid
                columns: 2
                square: false
                cards:
                  - type: entity
                    entity: sensor.solarprognose_aktuelle_stunde
                    name: Aktuelle Stunde
                  - type: entity
                    entity: sensor.solarprognose_nachste_stunde
                    name: Nächste Stunde
                  - type: entity
                    entity: sensor.solarprognose_heute_gesamt
                    name: Prognose Heute
                  - type: entity
                    entity: sensor.solarprognose_resttag
                    name: Verbleibend Heute
          - type: custom:apexcharts-card
            graph_span: 22h
            span:
              start: day
            now:
              show: true
              color: red
            header:
              show: true
              title: Solar-Vorhersage
              colorize_states: true
            series:
              - entity: sensor.solarprognose_prognose
                type: area
                color: orange
                name: Erwartete Energie
                opacity: 0.3
                stroke_width: 2
                unit: kW
                data_generator: |
                  /* Transformiert die Liste aus dem forecast-Attribut */
                  return entity.attributes.forecast.map((entry) => {
                    return [new Date(entry.datetime).getTime(), entry.value];
                  });
          - type: vertical-stack
            cards:
              - type: heading
                heading: Vorhersage & API
              - type: entities
                entities:
                  - entity: sensor.solarprognose_morgen_gesamt
                    secondary_info: last-updated
                  - type: divider
                  - entity: sensor.solarprognose_api_status
                    name: API Status
                  - entity: sensor.solarprognose_api_abfragen_heute
                    name: API Aufrufe (Counter)
                  - entity: sensor.solarprognose_letzte_abfrage
                    name: Letzter Abruf
                  - entity: sensor.solarprognose_nachste_abfragezeit
                    name: Nächster geplanter Abruf
      - type: grid
        cards:
          - type: vertical-stack
            cards:
              - type: heading
                heading: Solar-Vorhersage
                heading_style: title
                icon: mdi:sun-clock
              - type: grid
                columns: 2
                square: false
                cards:
                  - type: tile
                    entity: sensor.solarprognose_heute_gesamt
                    color: orange
                    vertical: false
                    features_position: bottom
                  - type: tile
                    entity: sensor.solarprognose_resttag
                    color: amber
              - type: energy-solar-graph
                title: Stündliche Kurve
              - type: entities
                entities:
                  - entity: sensor.solarprognose_morgen_gesamt
                  - entity: sensor.solarprognose_api_status
                  - entity: sensor.solarprognose_letzte_abfrage
    type: sections
    max_columns: 4
    cards: []
